FROM quay.io/guimou/s2i-minimal-notebook-f32:0.0.1
LABEL "io.k8s.display-name"="s2i-minimal-lmod:0.0.2" \
      "io.openshift.s2i.build.image"="quay.io/guimou/s2i-minimal-notebook-f32:0.0.1" \
      "io.openshift.s2i.build.commit.author"="Guillaume Moutier <guillaume.moutier@gmail.com>" \
      "io.openshift.s2i.build.commit.date"="Fri Feb 12 17:04:37 2021 -0500" \
      "io.openshift.s2i.build.commit.id"="0cc12d651a358f76ebe11b46d083e2567bf59657" \
      "io.openshift.s2i.build.commit.ref"="main" \
      "io.openshift.s2i.build.commit.message"="change source" \
      "io.openshift.s2i.build.source-location"="/home/gmoutier/Dev/repos/s2i-lmod-notebook/."
ENV JUPYTER_ENABLE_LAB="true" \
    CRIO_RUNTIME="true" \
    ENABLE_PIPENV="1" \
    THOTH_ADVISE="0" \
    THOTH_DRY_RUN="0" \
    THOTH_PROVENANCE_CHECK="0"
USER root
# Copying in override assemble/run scripts
COPY upload/scripts /tmp/scripts
# Copying in source code
COPY upload/src /tmp/src
# Change file ownership to the assemble user. Builder image must support chown command.
RUN chown -R 1001:0 /tmp/scripts /tmp/src
USER 1001
RUN /tmp/scripts/assemble
CMD /tmp/scripts/run
